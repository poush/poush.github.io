<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Connecting Social Apps with Orga API Server | Piyush Agrawal</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="Connecting Social Apps with Orga API Server" />
<meta name="author" content="poush" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Addition of a feature to Orga API Server Ability to connect your social apps with orga server" />
<meta property="og:description" content="Addition of a feature to Orga API Server Ability to connect your social apps with orga server" />
<meta property="og:site_name" content="Piyush Agrawal" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-23T04:11:24+02:00" />
<script type="application/ld+json">
{"description":"Addition of a feature to Orga API Server Ability to connect your social apps with orga server","@type":"BlogPosting","headline":"Connecting Social Apps with Orga API Server","dateModified":"2017-05-23T04:11:24+02:00","datePublished":"2017-05-23T04:11:24+02:00","url":"/fossasia/oauth/2017/05/23/connecting-social-apps-with-orga-api-server.html","mainEntityOfPage":{"@type":"WebPage","@id":"/fossasia/oauth/2017/05/23/connecting-social-apps-with-orga-api-server.html"},"author":{"@type":"Person","name":"poush"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" /><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Piyush Agrawal" /><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
  <link rel="stylesheet" href="/assets/dracula.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body><div class="site-header">
  <div class="wrapper wrapper-header">
    <a class="site-title" rel="author" href="/"><span class="muted">/Users/</span>Piyush Agrawal<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>

    <div class="author-box">

<!-- <img src="https://gravatar.com/avatar/e6e6f4e575ebd10763d358825bd441b5?s=256" class="author-avatar" /> -->

<span style="color: #50BD6A; float:right">A lazy developer on a mission to make life easy.
</span>
</div>

  </div>
</div>


<!-- <span class="social_links">
    <a class="color-cyan-hover" href="https://twitter.com/mepoush"><i class="fab fa-twitter-square"></i></a><a class="color-purple-hover" href="https://github.com/poush"><i class="fab fa-github-square"></i></a>
</span> -->

<main class="page-content" aria-label="Content">
      <div class="wrapper">

        <div class="filebox">
  <div class="full"></div>
  <div class="sidebar">
    <div class="controls">
      <a class="red" onclick="window.close()"></a>
      <a onclick="window.close()"></a>
      <a class="green" onclick="window.close()"></a>
    </div>
    








<ul>
    
    <li class=""> <a href="#" onclick="window.history.back()"> <i class="fas fa-arrow-left"></i> ../ </a></li>
    <li class="active"> <a href="#"> <i class="fas fa-file-alt white"></i> Connecting Social Apps with Orga API Server</a></li>
    

</ul>
  </div>
  <div class="content">
    <div class="post">
  <h1 class="post-title">Connecting Social Apps with Orga API Server</h1>
  
  <div class="post-tags">
    
    <a class="tag" href="/tag/fossasia/">fossasia</a>
    
    <a class="tag" href="/tag/API-server/">API-server</a>
    
    <a class="tag" href="/tag/OAuth/">OAuth</a>
    
    <a class="tag" href="/tag/social-apps/">social-apps</a>
    
  </div>
  
  <div class="post-date" style="color:#6d6d6d;">Published on 23 May 2017
  </div>
   <h2 id="addition-of-a-feature-to-orga-api-server">Addition of a feature to Orga API Server</h2>
<h3 id="ability-to-connect-your-social-apps-with-orga-server"><em>Ability to connect your social apps with orga server</em></h3>

<p><strong><em>What’s going to add?</em></strong></p>

<p>A feature which will allow us to provide Organizer options to connect with their social media audience directly with API server and Users to share their experience for different events on their social media platforms.</p>

<p><strong><em>Platforms added</em></strong></p>
<ul>
  <li><strong>F</strong>aceBook</li>
  <li><strong>T</strong>witter</li>
  <li><strong>I</strong>nstagram</li>
  <li><strong>G</strong>oogle+</li>
</ul>

<h3 id="the-auth-tool---oauth-20">The Auth Tool - OAuth 2.0</h3>
<p>Without going on introductory introduction to Oauth2.0 Let’s focus on its implementation in Orga API Server</p>

<p><strong>OAuth Roles</strong></p>

<p><em>OAuth defines four roles:</em></p>

<ul>
  <li>Resource Owner</li>
  <li>Client</li>
  <li>Resource Server</li>
  <li>Authorization Server</li>
</ul>

<p>Let’s look at the responsibility of these roles when you connect your social apps with API server</p>

<p><strong>Resource Owner: User/Organizer ( You )</strong></p>

<p>You as User or Organizer connection your accounts with API server are the resource owners who authorize API server to access your account. During authorization, you provide us access to read your account details like Name, Email, Profile photo, etc.</p>

<p><strong>Resource / Authorization Server: Social Apps</strong></p>

<p>The resource server here is your social platforms/apps where you have your account registered. These Apps provide us limited access to fetch details of your account once you authorize our application to do so.
They make sure the token we provide match with the authorization provided before through your account.</p>

<p><strong>Client: Orga API Server</strong></p>

<p>Orga API Server acts as the client to access your account details. Before it may do so, it must be authorized by the user, and the authorization must be validated by the API.</p>

<h3 id="the-process-to-add">The process to add</h3>
<p>A simple work plan to follow:</p>

<ol>
  <li>Understanding how OAuth is implemented.</li>
  <li>Test OAuth implementation on all 4 social medias.</li>
  <li>After Necessary correction. Make sure we have all views(routes) to connect these 4 social medias.</li>
  <li>Implementing the same feature on the template file.</li>
  <li>Make sure these connect buttons are shown only when Admin has registered its client credentials in Settings.</li>
  <li>Creating a view to unlink your social media account.</li>
</ol>

<p><strong>Understanding how OAuth is implemented.</strong></p>

<p>Current Implementation of OAuth is very simple and interesting on API server. We have OAuth helper classes which provide all necessary endpoints and different methods to get the job done.
<img src="/Screen%20Shot%202017-05-23%20at%205.17.52%20PM.png" alt="Oauth" /></p>

<p><strong>Test OAuth implementation on all 4 social medias.</strong></p>

<p>Now we can work on testing on the callbacks of all 4 social apps. We have callback defined in <code class="highlighter-rouge">views/util_routes.py</code>
For this, I picked up the auth OAuth URLs and called them directly on my browsers and testing their callback. Now on callback, those methods required some change to save user data on database thus connecting their accounts with API server. This lead to changes in <code class="highlighter-rouge">update_user_details</code> and on callback methods.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def update_user_details(first_name=None,
                        last_name=None,
                        facebook_link=None,
                        twitter_link=None,
                        file_url=None,
                        instagram=None,
                        google=None):
</code></pre></div></div>

<p><strong>Make sure we have all views(routes) to connect these 4 social medias</strong></p>

<p>This has to be done on <code class="highlighter-rouge">views/users/profile.py</code>
Addition of one method</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@profile.route('/google_connect/', methods=('GET', 'POST'))
def google_connect():
        ....
        ....
    return redirect(gp_auth_url)
</code></pre></div></div>
<p>and testing, correction on other 3 methods</p>

<p><strong>Implementing the same feature on template file.</strong></p>

<p>Updating <code class="highlighter-rouge">gentelella/users/settings/pages/applications.html</code>  to add changes required to add this feature. This included ability to show URLs of connected accounts and functioning connect and disconnect button</p>

<p><strong>Make sure these connect buttons are shown only when Admin has registered its client credentials in Settings.</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     fb = get_settings()['fb_client_id'] != None and get_settings()['fb_client_secret'] != None
        ....
        ....
        ...
</code></pre></div></div>

<p>The addition of such snippet provides data to the template to decide whether to show those fields or not. It will not make any sense if there is no application created to connect those accounts by Admin.</p>

<p><strong>Creating a view to unlink your social media account.</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>utils_routes.route('/unlink-social/&lt;social&gt;')
def unlink_social(social):
    if login.current_user is not None and login.current_user.is_authenticated:
        ...
        ...
</code></pre></div></div>
<p>A method is created to unlink the connected accounts so that users can anytime disconnect their accounts from API server.</p>

<p><strong>Where to connect?</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Settings &gt; Applications
</code></pre></div></div>

<p><em>How it Works</em>
<img src="https://www.dropbox.com/s/ra0fi45mo7i6jby/ScreenFlow.gif?dl=1" alt="Download" /></p>

</div>

  
<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
    <li>
      <h3>
        <a href="/2019/11/12/welcome-to-new-design.html">
          Welcome to new design!
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="/reset-password-in-open-even-api-server/">
          Reset password in Open Even API Server
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="/generating-ticket-pdfs-in-open-event-api-server/">
          Generating Ticket PDFs in Open Event API Server
        </a>
      </h3>
    </li>
    
  </ul>
</div>
 <!-- pagination -->


  </div>
</div>



      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><!-- <div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div> -->
<script type="text/javascript">
const theme = localStorage.getItem('theme');
if (theme === 'undefined') {
   theme = "dark";
}
if (theme === "dark") {
	document.documentElement.setAttribute('data-theme', 'dark');
} else {
    document.documentElement.setAttribute('data-theme', 'light');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    // document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	// document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    // document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

activateDarkTheme();
// function modeSwitcher() {
// 	let currentMode = document.documentElement.getAttribute('data-theme');
// 	if (currentMode === "dark") {
// 	    activateLightTheme();
// 	} else {
// 	    activateDarkTheme();
// 	}
// }
</script></div>
  </div>
</footer>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-152252318-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-152252318-1');
</script><script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
